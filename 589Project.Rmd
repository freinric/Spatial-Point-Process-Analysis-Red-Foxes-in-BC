---
title: "589Project"
author: "Nowshaba Durrani"
date: "2023-04-09"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## R Markdown

```{r}
# read the CSV file into a data frame
mydata <- read.delim("vulpes.csv", sep ="\t")

# view the first few rows of the data frame
#head(mydata)
```


```{r}
# Load the sp package
library(sp)
library(rgdal)
library(sf)
library(raster)

# Create a spatial points data frame from the longitude and latitude columns
coordinates <- mydata[,c("decimalLongitude", "decimalLatitude")]
dat.sp <- SpatialPointsDataFrame(c(mydata[,c('decimalLongitude','decimalLatitude')]), data = mydata)

# Set the current CRS
#proj4string(mydata) <- CRS("+proj=longlat +datum=WGS84")
proj4string(dat.sp)<- CRS("+proj=longlat +datum=WGS84")

# Define the new CRS you want to transform to
new_crs <- CRS("+proj=aea +lat_0=45 +lon_0=-126 +lat_1=50 +lat_2=58.5 +x_0=1000000 +y_0=0 +datum=NAD83 +units=m +no_defs")

# Transform the data to the new CRS
#data_transformed <- spTransform(mydata, new_crs)
data.sp_trans <- spTransform(dat.sp, new_crs)

#data_transformed
data.sp_trans

plot(data.sp_trans, main = "Locations in BC", cex = 0.8, col ="blue")
```
```{r}

library(spatstat)
library(maptools)
load("BC_Covariates.Rda")

#how to convert to OWIN object of this window so we can use the background?
#or do we have this window within our data itself?
#Convert the list to an owin object
#vulpes_win <- owin(poly = list(x=DATA$Parks$X,y=DATA$Parks$Y))

#Try to visualise the window using x and y
#plot(vulpes_win,
#     main = "Observation Window")

#As Window object is already present, use this to plot the observation window
plot(DATA$Window,
main = "Observation Window")
```



```{r}
#Convert to a ppp object, how to add Window? how to resolve 517 illegal points? what is it?
vulpes_ppp <- ppp(x = data.sp_trans$decimalLatitude, # X coordinates
                    y = data.sp_trans$decimalLongitude)#, # Y coordinates
                    #window = ves_win) # Observation window

#Visualise the dataset
plot(vulpes_ppp,
     pch = 16,
     cols = "#046C9A",
     main = "Vulpes point data")
```

```{r}
# Analyze first moment and plot intensity - 

```


```{r}
#add marks and relationship with one covariate to start with
vulpes_ppp <- ppp(x = data.sp_trans$decimalLatitude, # X coordinates
                    y = data.sp_trans$decimalLongitude)

#.....
```